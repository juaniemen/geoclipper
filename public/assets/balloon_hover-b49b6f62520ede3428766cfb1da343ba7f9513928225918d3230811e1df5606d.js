/**
 * Hover balloon on elements without css and images.
 *
 * Copyright (c) 2011 Hayato Takenaka
 * Dual licensed under the MIT and GPL licenses:
 * http://www.opensource.org/licenses/mit-license.php
 * http://www.gnu.org/licenses/gpl.html
 * @author: Hayato Takenaka (https://urin.github.io)
 * @version: 1.0.3 - 2016/07/02
 **/
!function(t){function e(){this.initialize.apply(this,arguments)}function n(n,i,r){function s(t,e,n,i,o){const s=Math.round(i/1.7320508);e.inactive()["setBorder"+n.camel.pos.f](i)["setBorder"+n.camel.pos.c1](s)["setBorder"+n.camel.pos.c2](s)["set"+n.camel.pos.p1](n.isTopLeft?-i:t.inner[n.size.p])["set"+n.camel.pos.c1](t.inner[n.size.c]/r.tipPosition-s).active().$.css("border-"+n.pos.f+"-color",o)}i.stop(!0,!0);var a,l;const c={position:"absolute",height:"0",width:"0",border:"solid 0 transparent"},d=new e(n),u=new e(i);if(u.setTop(-r.offsetY+(r.position&&r.position.indexOf("top")>=0?d.top-u.height:r.position&&r.position.indexOf("bottom")>=0?d.bottom:d.center.top-u.height/2)),u.setLeft(r.offsetX+(r.position&&r.position.indexOf("left")>=0?d.left-u.width:r.position&&r.position.indexOf("right")>=0?d.right:d.center.left-u.width/2)),r.tipSize>0){i.data("outerTip")&&(i.data("outerTip").remove(),i.removeData("outerTip")),i.data("innerTip")&&(i.data("innerTip").remove(),i.removeData("innerTip")),a=new e(t("<div>").css(c).appendTo(i)),l=new e(t("<div>").css(c).appendTo(i));for(var h,f=0;f<o.pos.length;f++){if(h=o.getRelativeNames(f),u.center[h.pos.c1]>=d[h.pos.c1]&&u.center[h.pos.c1]<=d[h.pos.c2])if(f%2===0){if(u[h.pos.o]>=d[h.pos.o]&&u[h.pos.f]>=d[h.pos.f])break}else if(u[h.pos.o]<=d[h.pos.o]&&u[h.pos.f]<=d[h.pos.f])break;h=null}h?(u["set"+h.camel.pos.p1](u[h.pos.p1]+(h.isTopLeft?1:-1)*(r.tipSize-u["border"+h.camel.pos.o])),s(u,a,h,r.tipSize,i.css("border-"+h.pos.o+"-color"),r.tipPosition),s(u,l,h,r.tipSize-2*u["border"+h.camel.pos.o],i.css("background-color"),r.tipPosition),i.data("outerTip",a.$).data("innerTip",l.$)):t.each([a.$,l.$],function(){this.remove()})}}function i(e,n){const i=e.data("balloon")&&e.data("balloon").get(0);return!(i&&(i===n.relatedTarget||t.contains(i,n.relatedTarget)))}const o={pos:t.extend(["top","bottom","left","right"],{camel:["Top","Bottom","Left","Right"]}),size:t.extend(["height","width"],{camel:["Height","Width"]}),getRelativeNames:function(t){const e={pos:{o:t,f:t%2===0?t+1:t-1,p1:t%2===0?t:t-1,p2:t%2===0?t+1:t,c1:2>t?2:0,c2:2>t?3:1},size:{p:2>t?0:1,c:2>t?1:0}},n={};for(var i in e){n[i]||(n[i]={});for(var r in e[i])n[i][r]=o[i][e[i][r]],n.camel||(n.camel={}),n.camel[i]||(n.camel[i]={}),n.camel[i][r]=o[i].camel[e[i][r]]}return n.isTopLeft=n.pos.o===n.pos.p1,n}};!function(){function n(t,e){if(null==e)return n(t,!0),n(t,!1);const i=o.getRelativeNames(e?0:2);return t[i.size.p]=t.$["outer"+i.camel.size.p](),t[i.pos.f]=t[i.pos.o]+t[i.size.p],t.center[i.pos.o]=t[i.pos.o]+t[i.size.p]/2,t.inner[i.pos.o]=t[i.pos.o]+t["border"+i.camel.pos.o],t.inner[i.size.p]=t.$["inner"+i.camel.size.p](),t.inner[i.pos.f]=t.inner[i.pos.o]+t.inner[i.size.p],t.inner.center[i.pos.o]=t.inner[i.pos.f]+t.inner[i.size.p]/2,t}const i={setBorder:function(t,e){return function(i){return this.$.css("border-"+t.toLowerCase()+"-width",i+"px"),this["border"+t]=i,this.isActive?n(this,e):this}},setPosition:function(t,e){return function(i){return this.$.css(t.toLowerCase(),i+"px"),this[t.toLowerCase()]=i,this.isActive?n(this,e):this}}};e.prototype={initialize:function(e){this.$=e,t.extend(!0,this,this.$.offset(),{center:{},inner:{center:{}}});for(var n=0;n<o.pos.length;n++)this["border"+o.pos.camel[n]]=parseInt(this.$.css("border-"+o.pos[n]+"-width"))||0;this.active()},active:function(){return this.isActive=!0,n(this),this},inactive:function(){return this.isActive=!1,this}};for(var r=0;r<o.pos.length;r++)e.prototype["setBorder"+o.pos.camel[r]]=i.setBorder(o.pos.camel[r],2>r),r%2===0&&(e.prototype["set"+o.pos.camel[r]]=i.setPosition(o.pos.camel[r],2>r))}(),t.fn.balloon=function(e){return this.one("mouseenter",function n(){const o=t(this),r=this,s=o.on("mouseenter",function(t){i(o,t)&&o.showBalloon()}).off("mouseenter",n).showBalloon(e).data("balloon");s&&s.on("mouseleave",function(e){r===e.relatedTarget||t.contains(r,e.relatedTarget)||o.hideBalloon()}).on("mouseenter",function(e){r===e.relatedTarget||t.contains(r,e.relatedTarget)||(s.stop(!0,!0),o.showBalloon())})}).on("mouseleave",function(e){const n=t(this);i(n,e)&&n.hideBalloon()})},t.fn.showBalloon=function(e){var i,o;return!e&&this.data("options")||(null===t.balloon.defaults.css&&(t.balloon.defaults.css={}),this.data("options",t.extend(!0,{},t.balloon.defaults,e||{}))),e=this.data("options"),this.each(function(){var r;if(i=t(this),r=!i.data("balloon"),o=i.data("balloon")||t("<div>"),r||!o.data("active")){o.data("active",!0),clearTimeout(o.data("minLifetime"));const s=t.isFunction(e.contents)?e.contents.apply(this):e.contents||i.attr("title")||i.attr("alt");i.removeAttr("title"),!e.url&&""===s||null==s||(t.isFunction(e.contents)||(e.contents=s),e.url?o.data("ajaxDisabled")||(""!==s&&null!=s&&(e.html?o.empty().append(s):o.text(s)),clearTimeout(o.data("ajaxDelay")),o.data("ajaxDelay",setTimeout(function(){o.load(t.isFunction(e.url)?e.url.apply(i.get(0)):e.url,function(t,r,s){"success"!==r&&"notmodified"!==r||(o.data("ajaxDisabled",!0),e.ajaxContentsMaxAge>=0&&setTimeout(function(){o.data("ajaxDisabled",!1)},e.ajaxContentsMaxAge),e.ajaxComplete&&e.ajaxComplete(t,r,s),n(i,o,e))})},e.ajaxDelay))):e.html?o.empty().append(s):o.text(s),r?(o.addClass(e.classname).css(e.css||{}).css({visibility:"hidden",position:"absolute"}).appendTo("body"),i.data("balloon",o),n(i,o,e),o.hide().css("visibility","visible")):n(i,o,e),o.data("delay",setTimeout(function(){e.showAnimation?e.showAnimation.apply(o.stop(!0,!0),[e.showDuration,function(){e.showComplete&&e.showComplete.apply(o)}]):o.show(e.showDuration,function(){this.style.removeAttribute&&this.style.removeAttribute("filter"),e.showComplete&&e.showComplete.apply(o)}),e.maxLifetime&&(clearTimeout(o.data("maxLifetime")),o.data("maxLifetime",setTimeout(function(){i.hideBalloon()},e.maxLifetime)))},e.delay)))}})},t.fn.hideBalloon=function(){const e=this.data("options");return this.data("balloon")?this.each(function(){const n=t(this),i=n.data("balloon");clearTimeout(i.data("delay")),clearTimeout(i.data("minLifetime")),clearTimeout(i.data("ajaxDelay")),i.data("minLifetime",setTimeout(function(){e.hideAnimation?e.hideAnimation.apply(i.stop(!0,!0),[e.hideDuration,function(n){t(this).data("active",!1),e.hideComplete&&e.hideComplete(n)}]):i.stop(!0,!0).hide(e.hideDuration,function(n){t(this).data("active",!1),e.hideComplete&&e.hideComplete(n)})},e.minLifetime))}):this},t.balloon={defaults:{contents:null,html:!1,classname:null,url:null,ajaxComplete:null,ajaxDelay:500,ajaxContentsMaxAge:-1,delay:0,minLifetime:200,maxLifetime:0,position:"top",offsetX:0,offsetY:0,tipSize:8,tipPosition:2,showDuration:100,showAnimation:null,hideDuration:80,hideAnimation:function(t,e){this.fadeOut(t,e)},showComplete:null,hideComplete:null,css:{fontSize:".7rem",minWidth:".7rem",padding:".2rem .5rem",border:"1px solid rgba(212, 212, 212, .4)",borderRadius:"3px",boxShadow:"2px 2px 4px #555",color:"#eee",backgroundColor:"#111",opacity:.85,zIndex:"32767",textAlign:"left"}}}}(jQuery);